// SPDX-License-Identifier: MIT
pragma solidity ^0.8.19;

// Contrato de Lógica (Implementação) Vulnerável
contract Logic {
    address public owner;
    uint256 public value;
    bool private _initialized;

    // A FUNÇÃO VULNERÁVEL (sem o modificador `initializer`)
    function initialize(address _newOwner) public {
        owner = _newOwner;
    }

    // Função de exemplo que o proxy usaria
    function setValue(uint256 _newValue) public {
        value = _newValue;
    }

    /**
     * @dev A FUNÇÃO DE EXPLORAÇÃO.
     * Protegida por `onlyOwner`, mas o 'owner' lido é o do
     * armazenamento deste contrato (que o invasor pode definir).
     */
    function emergencyWithdraw() public onlyOwner {
        // Envia todo o saldo deste contrato para o chamador
        payable(msg.sender).transfer(address(this).balance);
    }

    modifier onlyOwner() {
        require(msg.sender == owner, "Not the owner");
        _;
    }

    // Função para permitir que o contrato receba ETH
    receive() external payable {}

    // (Funções de upgrade UUPS omitidas por brevidade)
}